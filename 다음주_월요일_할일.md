# 다음 주 월요일 할 일 목록

**작성일**: 2026년 1월 9일 (목요일)  
**대상일**: 2026년 1월 13일 (월요일)

---

## 📋 이번 주 완료한 작업 요약

### ✅ 완료된 작업

1. **API 서버 자동 업데이트 문제 해결**
   - 문제: 다른 팀원이 푸시한 변경사항이 결과 페이지에 반영되지 않는 문제
   - 원인: 중앙 서버에서 `git pull` 및 서버 재시작이 필요함
   - 해결: 자동 업데이트 스크립트 생성 및 Cron Job 설정

2. **자동 업데이트 스크립트 생성**
   - `auto_update_and_restart.sh`: 수동 실행용 스크립트
   - `auto_update_smart.sh`: Cron Job용 스마트 업데이트 스크립트
   - 변경사항이 있을 때만 업데이트하도록 최적화

3. **완전 자동화 설정**
   - Cron Job 설정: 5분마다 자동으로 GitHub 변경사항 체크
   - 로그 파일 위치 변경: `/tmp` → 프로젝트 디렉토리
   - 로그 관리 시스템 구축

4. **문서화**
   - `Cron_작업_실행_조건_설명.md`: Cron Job 실행 조건 상세 설명
   - `로그_확인_가이드.md`: 로그 확인 방법 가이드
   - `로그_파일_위치_안내.md`: 로그 파일 위치 및 접근 방법

---

## 🎯 다음 주 월요일 할 일

### 🔴 우선순위 높음 (필수)

#### 1. 자동 업데이트 시스템 테스트 및 검증 ⏰ 30분

**목적**: 자동화 시스템이 정상 작동하는지 확인

**작업 내용**:
- [ ] 로그 파일 확인 (`api_auto_update.log`)
  ```bash
  tail -50 api_auto_update.log
  ```
- [ ] Cron Job 실행 상태 확인
  ```bash
  crontab -l
  ```
- [ ] 최근 24시간 동안의 자동 업데이트 이력 확인
  ```bash
  grep "$(date -d '1 day ago' +%Y-%m-%d)" api_auto_update.log | grep "업데이트 및 재시작 완료"
  ```
- [ ] API 서버 상태 확인
  ```bash
  curl http://192.168.0.18:8000/api/health
  ```

**예상 결과**: 
- Cron Job이 정상적으로 5분마다 실행되고 있음
- 로그에 정상적인 실행 기록이 있음
- API 서버가 정상 작동 중

---

#### 2. 실제 시나리오 테스트 ⏰ 1시간

**목적**: 다른 팀원이 푸시했을 때 자동으로 반영되는지 실제로 테스트

**작업 내용**:
- [ ] 테스트 브랜치 생성 또는 작은 변경사항 커밋
  ```bash
  # 테스트용 작은 변경 (예: 주석 추가)
  git checkout -b test-auto-update
  # 파일 하나 수정
  git add .
  git commit -m "test: 자동 업데이트 테스트"
  git push origin test-auto-update
  ```
- [ ] develop 브랜치에 테스트 커밋 푸시 (또는 팀원에게 요청)
- [ ] 5분 이내 자동 업데이트 확인
  ```bash
  tail -f api_auto_update.log
  ```
- [ ] API 서버 재시작 확인
  ```bash
  ps aux | grep "python.*main.py"
  ```
- [ ] 변경사항이 실제로 반영되었는지 확인
  - 웹 브라우저에서 리포트 페이지 확인
  - API 응답 확인

**예상 결과**:
- 푸시 후 5분 이내 자동으로 pull 및 재시작됨
- 변경사항이 결과 페이지에 반영됨

---

#### 3. 팀원들에게 변경사항 공유 ⏰ 30분

**목적**: 팀원들이 새로운 자동화 시스템을 이해하고 활용할 수 있도록 안내

**작업 내용**:
- [ ] README.md 업데이트 (자동 업데이트 시스템 추가)
- [ ] 팀 채널/이메일로 공지사항 작성
  - 자동 업데이트 시스템 도입 안내
  - 이제 푸시하면 자동으로 반영됨을 알림
  - 문제 발생 시 확인 방법 안내
- [ ] 주요 변경사항 요약 문서 작성 (선택사항)

**공지 내용 예시**:
```
[공지] API 서버 자동 업데이트 시스템 도입

이제 코드를 수정하고 GitHub에 푸시하면,
중앙 서버에서 자동으로 최신 코드를 가져와서
API 서버를 재시작합니다.

- 자동 체크 주기: 5분마다
- 최대 반영 시간: 5분 이내
- 로그 확인: /home/sth0824/ansible/api_auto_update.log

문제 발생 시 문의 부탁드립니다.
```

---

### 🟡 우선순위 중간 (권장)

#### 4. 로그 모니터링 대시보드 구축 (선택사항) ⏰ 2시간

**목적**: 자동 업데이트 상태를 쉽게 확인할 수 있는 대시보드

**작업 내용**:
- [ ] 간단한 로그 분석 스크립트 작성
  ```bash
  # 오늘의 업데이트 통계
  # 최근 업데이트 내역
  # 에러 발생 여부
  ```
- [ ] API 엔드포인트 추가 (선택사항)
  - `/api/auto-update/status`: 자동 업데이트 상태
  - `/api/auto-update/logs`: 최근 로그 조회

**참고**: 시간이 부족하면 다음 주로 미룰 수 있음

---

#### 5. 에러 처리 개선 ⏰ 1시간

**목적**: Git 충돌 등 에러 발생 시 대응 방안 개선

**작업 내용**:
- [ ] Git 충돌 발생 시 알림 기능 추가 (선택사항)
- [ ] 에러 로그 분석 및 개선점 파악
- [ ] 자동 롤백 기능 검토 (선택사항)

---

### 🟢 우선순위 낮음 (여유 있을 때)

#### 6. 문서 정리 및 업데이트 ⏰ 30분

**작업 내용**:
- [ ] 생성된 문서들 검토 및 정리
- [ ] README.md에 자동 업데이트 시스템 섹션 추가
- [ ] 불필요한 임시 파일 정리

---

#### 7. 성능 모니터링 ⏰ 30분

**작업 내용**:
- [ ] Cron Job 실행 시간 측정
- [ ] 서버 재시작 시간 측정
- [ ] 로그 파일 크기 모니터링

---

## 📝 체크리스트 요약

### 월요일 오전 (필수 작업)

- [ ] **09:00 - 09:30**: 자동 업데이트 시스템 상태 확인
- [ ] **09:30 - 10:30**: 실제 시나리오 테스트
- [ ] **10:30 - 11:00**: 팀원들에게 변경사항 공유

### 월요일 오후 (권장 작업)

- [ ] **14:00 - 16:00**: 로그 모니터링 대시보드 구축 (선택)
- [ ] **16:00 - 17:00**: 에러 처리 개선

---

## 🔍 확인 사항

### 월요일 아침에 확인할 것

1. **로그 파일 확인**
   ```bash
   tail -100 api_auto_update.log
   ```
   - 주말 동안 정상 작동했는지 확인
   - 에러가 있었는지 확인

2. **Cron Job 상태 확인**
   ```bash
   crontab -l
   systemctl status cron  # 또는 service cron status
   ```

3. **API 서버 상태 확인**
   ```bash
   curl http://192.168.0.18:8000/api/health
   ps aux | grep "python.*main.py"
   ```

---

## ⚠️ 주의사항

1. **테스트 시 주의**
   - 테스트 브랜치를 사용하거나
   - 작은 변경사항으로만 테스트
   - 프로덕션에 영향을 주지 않도록 주의

2. **로그 파일 관리**
   - 로그 파일이 계속 쌓이므로 주기적으로 확인
   - 필요시 백업 후 초기화

3. **팀원 공지**
   - 자동 업데이트 시스템이 도입되었음을 명확히 전달
   - 문제 발생 시 확인 방법 안내

---

## 📞 문제 발생 시

1. **자동 업데이트가 작동하지 않을 때**
   ```bash
   # 로그 확인
   tail -50 api_auto_update.log
   
   # 수동 실행 테스트
   ./auto_update_smart.sh
   
   # Cron Job 확인
   crontab -l
   ```

2. **Git 충돌 발생 시**
   - 로그에서 확인
   - 수동으로 해결 후 다시 푸시

3. **API 서버 재시작 실패 시**
   ```bash
   # 서버 상태 확인
   ps aux | grep python
   
   # 수동 재시작
   ./stop_api_server.sh
   ./start_api_server.sh
   ```

---

## 🎯 성공 기준

다음 주 월요일 종료 시점에:

- ✅ 자동 업데이트 시스템이 정상 작동함을 확인
- ✅ 실제 시나리오 테스트 성공
- ✅ 팀원들에게 변경사항 공유 완료
- ✅ 문제 발생 시 대응 방법 문서화

---

**작성자**: 성태환  
**최종 업데이트**: 2026년 1월 9일
